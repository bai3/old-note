---
title: 网络基础知识
date: 2017-06-18 18:59:06
tags:
	- http
	- 网络知识
categories: note
---

记录一下:因为上上个学期不好好学习，导致我的信息技术考试考了55分，结果今年又要重修，所以在距离考试还有5天的时间，我得认真复习，因为以后可能就走这个行业，所以还是做好笔记认认真真复习一遍。

<!-- more -->

# TCP/IP介绍

## 简介

TCP/IP 中译名为传输控制协议/因特网互联协议，由网络层的IP协议和传输层的TCP协议组成。TCP/IP 定义了电子设备如何连入因特网，以及数据如何在它们之间传输的标准，是一组协议族。协议采用了4层的层级结构，每一层都呼叫它的下一层所提供的网络来完成自己的需求。通俗而言：TCP负责发现传输的问题，一有问题就发出信号，要求重新传输，直到所有数据安全正确地传输到目的地。而IP是给因特网的每一台电脑规定一个地址。

OSI模型中，应用层、传输层和数据链路层保证了数据的可靠性。

OSI模型

- 应用层
- 表示层
- 会话层
- 传输层
- 网络层
- 数据链路层
- 物理层

TCP/IP模型

- 应用层
- 传输层
- 网际层
- 网络接口层

![截图20170619122155](网络基础知识\截图20170619122155.png)

## 数据封装过程

例如发送一封电子邮件

1. 应用层将数据编码成电子邮件并发送给传输层
2. 传输层将信息分段，并在其头部添加控制信息（保证分段在目的地按顺序重组），构成数据段，发送给网际层。
3. 网际层在数据段的IP头部添加IP地址信息，构成数据包，发送给网络接口层
4. 网络接口层在数据包的头部添加MAC地址，构成帧。帧的尾部添加差错检查信息（FCS）
5. 物理层将帧编码成能在介质上传输到目的地的比特流![截图20170619124351](网络基础知识\截图20170619124351.png)


## CISCO设备

交换机：二层交换机工作在OSI的数据链路层

​	       三层交换机同事工作在OSI的数据链路层和网络层

网关：从表面来看工作在三层，实际上网关是一个杂合物，属于所有层都有，七层。

网桥：数据链路层

路由器：网络层

交换机和路由器的区别：

- 交换机工作在第二层，路由器工作在第三层
- 交换机使用MAC地址寻址（物理地址），路由器使用IP地址寻址（逻辑地址）
- 交换机的主要作用将PC连接在一起，而路由器主要作用是路由选择和分割广播域

# OSI模型各层介绍

## 物理层

### 物理层功能

是利用物理传输介质为数据链路层提供物理连接，以便透明的传输比特流，简单说就是设置网络拓扑结构、比特传输、位同步。

数据表现形式：比特流，这样的叫法叫PDU(协议数据单元)

### 介质

三种介质：铜缆，光纤，无线介质

铜介质：粗缆、细缆、双绞线

### 拓扑结构

物理拓扑：是根据网络设备的实际物理地址进行扫描而得到

类型：bus(总线型)，ring(环状拓扑)，star(星型拓扑)，tree(树型拓扑)，net(网状拓扑)

逻辑拓扑：是以网络设备的IP地址划分为依据生成的拓扑图

类型：广播broadcast，令牌传递/令牌环token-passing

### 主要设备

中继器、集线器

## 数据链路层

### 数据链路层功能

在此层将数据分帧，并处理流控。屏蔽物理层，为网络层提供一个数据链路的链接，在一条有可能出差错的物理连接上，进行几乎无差错的数据传输。本层指定拓扑结果并提供硬件寻址

简单地说就是：**成帧、物理寻址、流量、差错控制**

数据表示形式：帧

### 主要设备

交换机

### 交换模式

- 直通式（Cut Through）：当输入端口检测到一个数据包时，就检查该包的爆头，根据包内的目的地地址把数据包直通到相应的端口。
- 存储转发式（Store and Forward）：这种方法先将数据包完整的接收下路，经过CRC检查，如果数据包没有错误，在根据地址进行转发。
- 无碎片转发（Fragment Free）：它检查数据包的长度是否够64字节，若小于64字节，说明是弃包，进行丢弃，若大于64字节，则发送该报

### MAC地址(考试重点)

表示：6个字节，48个二进制位

MAC地址与Ipv6的联系：

MAC地址生成64位主机地址规则：

- 从左边数第一份倒数第二个字节取反，与第二个字节合写
- 第三个字节后加ff
- 第四个字节前面加上fe
- 第五个和第六个字节合写

**例：00-13-D3-02-F7-30 → 0213-D3ff-fe02-F730**

注释**MAC地址是硬件地址（物理地址），作用在数据链路层，而IP地址是软件地址（逻辑地址），作用在网络层**

### ARP(地址解析协议) 

功能：将IP地址解析为对应的MAC地址

**考题：**两台主机无法通信的原因（ARP角度）

**解答：**当发送接收双方主机在一个网段时，当一个主机向另一台主机发送通讯时，认为两者在同一网段，这时会进行不断请求，而消息将会发送到错误的目的地，导致无法通讯，解决方法是使用代理ARP。

RARP(逆向地址解析协议)(反向ARP协议)

功能:将MAC地址解析为对应的IP得知

### 以太网

组成：物理层+部分数据链路层，即OSI模型1,2层



## 网络层

### 网络层功能

本层通过寻址来建立两个节点之间的连接，为源端的运输层送来的分组，选择合适的路由和交换节点，正确无误地按照地址传送给目的端的运输层。它包括通过互联网络开路由和中继数据。

简单来说就是：**逻辑寻址，路由选择**

数据表示形式：数据包

### IP地址

- 构成：IP地址=网络地址位+主机地址位

- 作用：识别与定位

- 分类

  - A类：0.0.0.0-127.255.255.255 8位网咯地址+24位主机地址
  - B类：128.0.0.0-191.255.255.255 16位网络地址+16位主机地址
  - C类：192.0.0.0-223.255.255.255 24位网络地址+8位主机地址
  - D类：224.0.0.0-239.255.255.255 组播地址
  - E类： 240.0.0.0-255.255.255.255(其中255.255.255.255为全网广播地址)，E类地址一般用于研究作用

- 广播地址和网络地址

  广播地址：主机位全为1，网络地址：主机位全为0

- 子网掩码：

  - 定义：网络地址位全为1+主机地址全为0
  - 网络地址=IP地址&子网掩码
  - 表示：
    - /n n为网络地址位长度 
    - /8→255.0.0.0 /9→255.128.0.0
  - 作用：分割子网，将IP地址与子网掩码做与操作，将相同的合并在同一个子网中

- IPV6

  长度：128位，64位网络地址+64为主机地址

### 主要设备

路由器

## 传输层

### 传输层功能

常规数据递送，两种递送方式：面向连接（TCP）或无连接（UDP）。为会话层用户提供一个端到端的可靠、透明盒优化的数据传输服务机制。包括全双工或半双工、流控制和错误恢复服务。

简单的说就是：**端口寻址、分段重组、流量、差错控制**

数据表示形式：数据段

### 两个协议：TCP和UDP

- TCP：当发送方发送数据段时，发送方需要TCP协议与接收方连接建立会话，采用三次握手的方式，连接后即可建立虚数据进行发送数据通信，使用TCP协议连接时都要建立三次握手原则。

- UDP：当发送方发送数据段时，不需要和接收方进行协商联系，也不给数据段标号，直接发送过去，并不关心数据段是否到达接收方

- 使用TCP协议规则的协议有：FTP HTTP SMTP Telent DNS

  使用UDP协议规则的协议有： TFTP SNMP DHCP DNS

- TCP和UDP优缺点

| TCP                                      | UDP              |
| ---------------------------------------- | ---------------- |
| TCP协议面向连接                                | UDP协议面向非连接       |
| TCP协议传输速度慢                               | UDP协议传输速度快       |
| TCP协议采用字节流方式，如果字节流太长，将其分段，保证数据顺序，不出现丢失或乱序 | UDP协议不保证，尽最大能力交付 |
| TCP协议对系统资源要求多                            | UDP协议要求少         |
| TCP协议保证数据正确性，超时重发，丢弃重复数据，有可靠性            | UDP协议可能丢包        |
| TCP协议提供端到端、全双工通信                         | UDP协议是广播式的       |

### 三次握手原理（考试重点）

TCP是因特网中的传输层协议，使用三从握手协议建立连接，这种建立连接的方法可以防止产生错误的连接。

字段含义：

- ACK 确认字段
- SYN 同步序列号![截图20170619142851](网络基础知识\截图20170619142851.png)

过程

- 第一次握手：建立连接时，客户端发送syn数据段到服务器，并等待服务器确认。
- 第二次握手：服务器收到syn数据段，从而建立于客户端的会话，为了确认收到客户的SYN包，同时自己也发送一个SYN数据段，即SYN+ACK，
- 第三次握手：客户端收到服务器的SYN+ACK数据段，向服务器发送包含ACK数据段，此数据段发送完毕后，客户端和服务器进入TCP连接成功状态，完成三次握手。

会话：

两种状态：创建会话(采用三次握手)，终止(发送FIN消息)



## 应用层

### 会话层功能

 在两个节点之间建立端连接，为端系统的应用程序之间提供了对话控制机制。此服务包括建立连接时以全双工还是以半双工的方式进行设置。

简单地说就是：对话控制，建立同步

### 表示层功能

主要用于处理两个通信系统中交换信息的表示方式。为上层用户解决用户信息的语法问题。它包括数据格式交换、数据加密与解密、数据压缩与恢复等

简单地说就是：翻译、加密、压缩

### 应用层功能

为特定类型的网络应用提供了访问OSI环境的手段。应用层确定进程之间通信的性质，以满足用户的需要。应用层不仅要提供应用程序所需要的信息交换和远程操作，而且还要作为应用进程的用户代理，来完成一些为进行信息交换所必需的功能。它包括：文件传送访问和管理FTAM，虚拟终端VT、事物处理TP、远程数据库访问RDA、制造业报文规范MMS、目录服务DS等协议

简单地说就是文件传输、电子邮件、文件服务、虚拟终端‘

三层的数据表现形式：一般称为消息

## TCP/IP模型应用层协议

这个就不详细讲了

TCP/IP模型应用层协议端口

| 协议             | 端口   | 采用协议    |
| -------------- | ---- | ------- |
| 文件传输协议(FTP)数据  | 20   | TCP     |
| 文件传输系诶(FTP)控制  | 21   | TCP     |
| Talnet(远程登录)   | 23   | TCP     |
| 简单邮件传输协议(SMTP) | 25   | TCP     |
| 简单文件传输协议(TFTP) | 69   | UDP     |
| 超文本传输协议(HTTP)  | 80   | TCP     |
| 域名系统(DNS)      | 53   | TCP/UDP |
| 邮局协议(POP3)     | 110  | TCP     |
| 安全的HTTP(HTTPS) | 443  | TCP     |

# 思科考试重点：

填空题：

1. 在以太网中，ip的作用是**识别**和**定位**。
2. TCP通过使用**流量控制**和**滑动窗口**来提供阻塞控制
3. 对于在不同网段的两台主机，在数据的传输过程中，从源主机发送后，到目的主机接收前，数据所经过的OSI模型的最高层是**网络层**
4. **ipconfig**  查找网关IP地址，**tracert**追踪用于返回数据包在网络中传输时，沿途经过的跳列表，即追踪从源主机到目的主机所经过的路由器地址，**nslookup**  手动查询域名服务器指令

各层的协议

应用层：

- DNS
- HTTP
- SMTP(简单邮件传输协议)
- POP
- POP3
- Telent
- DHCP(动态主机配置协议)
- FTP

网际层协议

- ARP
- RARP
- ICMP

传输层协议

* TCP
* UDP

ping不通目的主机各层可能发生的错误

- 物理层故障：线缆短路，接口故障，速率、双工状态不一致
- 数据链路层：数据帧的封装格式不同
- 网路层：没有安装相应协议，没有设置正确IP地址。

网页无法连接各层可能发生的错误

- 物理层故障：网线松动，接口故障
- 数据链路层：设备配置错误，设备没有安装驱动程序，例如网卡驱动
- 网络层：IP地址是否配置正确，子网掩码是否正确，网关是否正确，DNS或DHCO设置是否正确
- 传输层：防火墙设置错误，应用程序的TCP或UDP端口是否被打开
- 会话层、表示层、应用层：应用软件故障。

题目：请以OSI七层模型为例，说明在网络通信过程中，如何保证数据的可靠性

- 传输层 ：滑动窗口，序列号，确认
- 数据链路层 ：帧检测序列FCS
- 应用层：校验文件类型

题目：210.34.160.0/24网段分成两个字网，由于客户端(client)子网掩码设置错误,都设成255.255.255.0，造成两个子网不能正常通信，请解释

1. 子网掩码的作用

定义地址的网络和主机部分，子网划分

1.  不能通信的原因（从ARP的角度）

当发送接收双方主机在一个网段时，当一个主机向另一台主机发送通讯时，认为两者在同一网段，这时会进行不断请求，而消息将会发送到错误的目的地，导致无法通讯

题目：请解释数据到传输层后，物理层前，这些层对数据封装

- 传输层分割数据，成段
- 网络层：加上相应的IP报头
- 数据链路层加上报尾形成帧

题目·数据在各个阶段的PDU

- 物理层：比特流 bit
- 数据链路层：帧frame
- 网络层：数据包packet
- 传输层：数据段segment  






