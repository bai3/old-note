# 第5章 与HTTP协作的Web服务器

## 5.1 用单台虚拟主机实现多个域名

HTTP/1.1规范允许一台HTTP服务器搭建多个Web站点。比如提供Web托管服务的供应商。可以用一台服务器为多位客户服务，也可以以每位客户持有的域名运行各自不同的网站。这是因为利用了虚拟主机的功能。

**在相同的IP地址下，由于虚拟主机可以寄存多个不同主机名和域名的WEB网站，因此在发送HTTP请求时，必须在Host首部内完整指定主机名或域名的URI**

## 5.2 通信数据转发程序：代理、网关、隧道

- 代理

  代理是一种有转发功能的应用程序，它扮演了位于服务器和客户端“中间人”的角色，接收有客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。

- 网关

  网关是转发给其他服务器通信数据的服务器，接收从客户端发送来的请求时，它就像自已拥有资源的源服务器一样对请求进行处理

- 隧道

  隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序。

###5.2.1 代理

代理服务器的基本行为就是接收客户端发送的请求后转发给其他服务器。

在HTTP通信时，可级联多台代理服务器。请求和响应的转发会经过数台类似锁链一样连接起来的代理服务器。**转发时，需要附加Via首部字段以标记出经过的主机的信息。**、

使用代理服务器的理由有：利用缓存技术减少网络带宽的流量，组织内部针对特定网站的访问控制，以获取访问日志为主要目的

**代理有多种使用方法，按两种基准分类：一种是是否使用缓存，另一种是是否会修改报文。**

- 缓存代理

  代理转发响应是，缓存代理会预先将资源的副本保存在代理服务器上。

  当代理再次接收到相同的资源的请求时，就可以不从源服务器哪里获取资源，而是将之前缓存的资源作于响应返回。

- 透明代理

  转发请求或响应的时，不对报文做任何加工的代理类型被称为透明代理。反之，对报文内容进行加工的代理被称为非透明代理

### 5.2.2 网关

利用网关可以由HTTP请求转化为其他协议通信

利用网关能提高通信的安全性，因为可以在客户端与网关之间的通信线路上加密以确保廉洁的安全。

### 5.2.3 隧道

隧道可以按要求建立一条与其他服务器的通信线路，届时使用SSL等加密手段进行通信。隧道的目的是确保客户端能与服务器进行安全通信。

## 5.3 保存资源额缓存

缓存是指代理服务器或客户端本地磁盘内保存的资源副本。利用缓存可减少对源服务器的访问，因此节省了通信流量和通信时间。

### 5.3.1 缓存的有效期限

### 5.3.2 客户端的缓存

缓存不仅可以存在于缓存服务器内，还可以存在客户端浏览器中，把客户端缓存称为临时网络文件